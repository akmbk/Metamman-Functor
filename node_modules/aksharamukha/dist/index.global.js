"use strict";var Aksharamukha=(()=>{var cs=Object.create;var Ee=Object.defineProperty;var fs=Object.getOwnPropertyDescriptor;var us=Object.getOwnPropertyNames;var hs=Object.getPrototypeOf,ds=Object.prototype.hasOwnProperty;var p=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var ps=(t,e)=>()=>(t&&(e=t(t=0)),e);var v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),yt=(t,e)=>{for(var r in e)Ee(t,r,{get:e[r],enumerable:!0})},gt=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of us(e))!ds.call(t,s)&&s!==r&&Ee(t,s,{get:()=>e[s],enumerable:!(i=fs(e,s))||i.enumerable});return t};var x=(t,e,r)=>(r=t!=null?cs(hs(t)):{},gt(e||!t||!t.__esModule?Ee(r,"default",{value:t,enumerable:!0}):r,t)),ms=t=>gt(Ee({},"__esModule",{value:!0}),t);var L=v((tn,xt)=>{"use strict";var St=["nodebuffer","arraybuffer","fragments"],Et=typeof Blob<"u";Et&&St.push("blob");xt.exports={BINARY_TYPES:St,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:Et,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var ae=v((rn,xe)=>{"use strict";var{EMPTY_BUFFER:_s}=L(),We=Buffer[Symbol.species];function ys(t,e){if(t.length===0)return _s;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),i=0;for(let s=0;s<t.length;s++){let n=t[s];r.set(n,i),i+=n.length}return i<e?new We(r.buffer,r.byteOffset,i):r}function vt(t,e,r,i,s){for(let n=0;n<s;n++)r[i+n]=t[n]^e[n&3]}function wt(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}function gs(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}function $e(t){if($e.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new We(t):ArrayBuffer.isView(t)?e=new We(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),$e.readOnly=!1),e}xe.exports={concat:ys,mask:vt,toArrayBuffer:gs,toBuffer:$e,unmask:wt};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=p("bufferutil");xe.exports.mask=function(e,r,i,s,n){n<48?vt(e,r,i,s,n):t.mask(e,r,i,s,n)},xe.exports.unmask=function(e,r){e.length<32?wt(e,r):t.unmask(e,r)}}catch{}});var Ot=v((sn,kt)=>{"use strict";var bt=Symbol("kDone"),je=Symbol("kRun"),qe=class{constructor(e){this[bt]=()=>{this.pending--,this[je]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[je]()}[je](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[bt])}}};kt.exports=qe});var ce=v((nn,Ct)=>{"use strict";var le=p("zlib"),Pt=ae(),Ss=Ot(),{kStatusCode:Tt}=L(),Es=Buffer[Symbol.species],xs=Buffer.from([0,0,255,255]),we=Symbol("permessage-deflate"),A=Symbol("total-length"),Y=Symbol("callback"),I=Symbol("buffers"),J=Symbol("error"),ve,Ve=class{constructor(e,r,i){if(this._maxPayload=i|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!ve){let s=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;ve=new Ss(s)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[Y];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,i=e.find(s=>!(r.serverNoContextTakeover===!1&&s.server_no_context_takeover||s.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>s.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!s.client_max_window_bits));if(!i)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(i.server_no_context_takeover=!0),r.clientNoContextTakeover&&(i.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(i.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?i.client_max_window_bits=r.clientMaxWindowBits:(i.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete i.client_max_window_bits,i}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(i=>{let s=r[i];if(s.length>1)throw new Error(`Parameter "${i}" must have only a single value`);if(s=s[0],i==="client_max_window_bits"){if(s!==!0){let n=+s;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${i}": ${s}`);s=n}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${i}": ${s}`)}else if(i==="server_max_window_bits"){let n=+s;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${i}": ${s}`);s=n}else if(i==="client_no_context_takeover"||i==="server_no_context_takeover"){if(s!==!0)throw new TypeError(`Invalid value for parameter "${i}": ${s}`)}else throw new Error(`Unknown parameter "${i}"`);r[i]=s})}),e}decompress(e,r,i){ve.add(s=>{this._decompress(e,r,(n,o)=>{s(),i(n,o)})})}compress(e,r,i){ve.add(s=>{this._compress(e,r,(n,o)=>{s(),i(n,o)})})}_decompress(e,r,i){let s=this._isServer?"client":"server";if(!this._inflate){let n=`${s}_max_window_bits`,o=typeof this.params[n]!="number"?le.Z_DEFAULT_WINDOWBITS:this.params[n];this._inflate=le.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[we]=this,this._inflate[A]=0,this._inflate[I]=[],this._inflate.on("error",ws),this._inflate.on("data",Nt)}this._inflate[Y]=i,this._inflate.write(e),r&&this._inflate.write(xs),this._inflate.flush(()=>{let n=this._inflate[J];if(n){this._inflate.close(),this._inflate=null,i(n);return}let o=Pt.concat(this._inflate[I],this._inflate[A]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[A]=0,this._inflate[I]=[],r&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),i(null,o)})}_compress(e,r,i){let s=this._isServer?"server":"client";if(!this._deflate){let n=`${s}_max_window_bits`,o=typeof this.params[n]!="number"?le.Z_DEFAULT_WINDOWBITS:this.params[n];this._deflate=le.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[A]=0,this._deflate[I]=[],this._deflate.on("data",vs)}this._deflate[Y]=i,this._deflate.write(e),this._deflate.flush(le.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let n=Pt.concat(this._deflate[I],this._deflate[A]);r&&(n=new Es(n.buffer,n.byteOffset,n.length-4)),this._deflate[Y]=null,this._deflate[A]=0,this._deflate[I]=[],r&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),i(null,n)})}};Ct.exports=Ve;function vs(t){this[I].push(t),this[A]+=t.length}function Nt(t){if(this[A]+=t.length,this[we]._maxPayload<1||this[A]<=this[we]._maxPayload){this[I].push(t);return}this[J]=new RangeError("Max payload size exceeded"),this[J].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[J][Tt]=1009,this.removeListener("data",Nt),this.reset()}function ws(t){if(this[we]._inflate=null,this[J]){this[Y](this[J]);return}t[Tt]=1007,this[Y](t)}});var Z=v((on,be)=>{"use strict";var{isUtf8:Lt}=p("buffer"),{hasBlob:bs}=L(),ks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Os(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}function Ge(t){let e=t.length,r=0;for(;r<e;)if((t[r]&128)===0)r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}function Ps(t){return bs&&typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&(t[Symbol.toStringTag]==="Blob"||t[Symbol.toStringTag]==="File")}be.exports={isBlob:Ps,isValidStatusCode:Os,isValidUTF8:Ge,tokenChars:ks};if(Lt)be.exports.isValidUTF8=function(t){return t.length<24?Ge(t):Lt(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=p("utf-8-validate");be.exports.isValidUTF8=function(e){return e.length<32?Ge(e):t(e)}}catch{}});var Ze=v((an,Bt)=>{"use strict";var{Writable:Ts}=p("stream"),At=ce(),{BINARY_TYPES:Ns,EMPTY_BUFFER:Rt,kStatusCode:Cs,kWebSocket:Ls}=L(),{concat:ze,toArrayBuffer:As,unmask:Rs}=ae(),{isValidStatusCode:Ds,isValidUTF8:Dt}=Z(),ke=Buffer[Symbol.species],k=0,It=1,Ft=2,Ut=3,He=4,Ye=5,Oe=6,Je=class extends Ts{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Ns[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Ls]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=k}_write(e,r,i){if(this._opcode===8&&this._state==k)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let i=this._buffers[0];return this._buffers[0]=new ke(i.buffer,i.byteOffset+e,i.length-e),new ke(i.buffer,i.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let i=this._buffers[0],s=r.length-e;e>=i.length?r.set(this._buffers.shift(),s):(r.set(new Uint8Array(i.buffer,i.byteOffset,e),s),this._buffers[0]=new ke(i.buffer,i.byteOffset+e,i.length-e)),e-=i.length}while(e>0);return r}startLoop(e){this._loop=!0;do switch(this._state){case k:this.getInfo(e);break;case It:this.getPayloadLength16(e);break;case Ft:this.getPayloadLength64(e);break;case Ut:this.getMask();break;case He:this.getData(e);break;case Ye:case Oe:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let r=this.consume(2);if((r[0]&48)!==0){let s=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(s);return}let i=(r[0]&64)===64;if(i&&!this._extensions[At.extensionName]){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._fin=(r[0]&128)===128,this._opcode=r[0]&15,this._payloadLength=r[1]&127,this._opcode===0){if(i){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(!this._fragmented){let s=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._compressed=i}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let s=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(s);return}if(i){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let s=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(s);return}}else{let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(r[1]&128)===128,this._isServer){if(!this._masked){let s=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(s);return}}else if(this._masked){let s=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(s);return}this._payloadLength===126?this._state=It:this._payloadLength===127?this._state=Ft:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let r=this.consume(8),i=r.readUInt32BE(0);if(i>Math.pow(2,21)-1){let s=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(s);return}this._payloadLength=i*Math.pow(2,32)+r.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let r=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(r);return}this._masked?this._state=Ut:this._state=He}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=He}getData(e){let r=Rt;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Rs(r,this._mask)}if(this._opcode>7){this.controlMessage(r,e);return}if(this._compressed){this._state=Ye,this.decompress(r,e);return}r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage(e)}decompress(e,r){this._extensions[At.extensionName].decompress(e,this._fin,(s,n)=>{if(s)return r(s);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");r(o);return}this._fragments.push(n)}this.dataMessage(r),this._state===k&&this.startLoop(r)})}dataMessage(e){if(!this._fin){this._state=k;return}let r=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=ze(i,r):this._binaryType==="arraybuffer"?s=As(ze(i,r)):this._binaryType==="blob"?s=new Blob(i):s=i,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=k):(this._state=Oe,setImmediate(()=>{this.emit("message",s,!0),this._state=k,this.startLoop(e)}))}else{let s=ze(i,r);if(!this._skipUTF8Validation&&!Dt(s)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(n);return}this._state===Ye||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=k):(this._state=Oe,setImmediate(()=>{this.emit("message",s,!1),this._state=k,this.startLoop(e)}))}}controlMessage(e,r){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Rt),this.end();else{let i=e.readUInt16BE(0);if(!Ds(i)){let n=this.createError(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");r(n);return}let s=new ke(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Dt(s)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");r(n);return}this._loop=!1,this.emit("conclude",i,s),this.end()}this._state=k;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=k):(this._state=Oe,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=k,this.startLoop(r)}))}createError(e,r,i,s,n){this._loop=!1,this._errored=!0;let o=new e(i?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(o,this.createError),o.code=n,o[Cs]=s,o}};Bt.exports=Je});var Qe=v((cn,$t)=>{"use strict";var{Duplex:ln}=p("stream"),{randomFillSync:Is}=p("crypto"),Mt=ce(),{EMPTY_BUFFER:Fs,kWebSocket:Us,NOOP:Bs}=L(),{isBlob:K,isValidStatusCode:Ms}=Z(),{mask:Wt,toBuffer:B}=ae(),O=Symbol("kByteLength"),Ws=Buffer.alloc(4),Pe=8*1024,M,X=Pe,P=0,$s=1,js=2,Ke=class t{constructor(e,r,i){this._extensions=r||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=P,this.onerror=Bs,this[Us]=void 0}static frame(e,r){let i,s=!1,n=2,o=!1;r.mask&&(i=r.maskBuffer||Ws,r.generateMask?r.generateMask(i):(X===Pe&&(M===void 0&&(M=Buffer.alloc(Pe)),Is(M,0,Pe),X=0),i[0]=M[X++],i[1]=M[X++],i[2]=M[X++],i[3]=M[X++]),o=(i[0]|i[1]|i[2]|i[3])===0,n=6);let a;typeof e=="string"?(!r.mask||o)&&r[O]!==void 0?a=r[O]:(e=Buffer.from(e),a=e.length):(a=e.length,s=r.mask&&r.readOnly&&!o);let c=a;a>=65536?(n+=8,c=127):a>125&&(n+=2,c=126);let l=Buffer.allocUnsafe(s?a+n:n);return l[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(l[0]|=64),l[1]=c,c===126?l.writeUInt16BE(a,2):c===127&&(l[2]=l[3]=0,l.writeUIntBE(a,4,6)),r.mask?(l[1]|=128,l[n-4]=i[0],l[n-3]=i[1],l[n-2]=i[2],l[n-1]=i[3],o?[l,e]:s?(Wt(e,i,l,n,a),[l]):(Wt(e,i,e,0,a),[l,e])):[l,e]}close(e,r,i,s){let n;if(e===void 0)n=Fs;else{if(typeof e!="number"||!Ms(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)n=Buffer.allocUnsafe(2),n.writeUInt16BE(e,0);else{let a=Buffer.byteLength(r);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");n=Buffer.allocUnsafe(2+a),n.writeUInt16BE(e,0),typeof r=="string"?n.write(r,2):n.set(r,2)}}let o={[O]:n.length,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==P?this.enqueue([this.dispatch,n,!1,o,s]):this.sendFrame(t.frame(n,o),s)}ping(e,r,i){let s,n;if(typeof e=="string"?(s=Buffer.byteLength(e),n=!1):K(e)?(s=e.size,n=!1):(e=B(e),s=e.length,n=B.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[O]:s,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};K(e)?this._state!==P?this.enqueue([this.getBlobData,e,!1,o,i]):this.getBlobData(e,!1,o,i):this._state!==P?this.enqueue([this.dispatch,e,!1,o,i]):this.sendFrame(t.frame(e,o),i)}pong(e,r,i){let s,n;if(typeof e=="string"?(s=Buffer.byteLength(e),n=!1):K(e)?(s=e.size,n=!1):(e=B(e),s=e.length,n=B.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[O]:s,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};K(e)?this._state!==P?this.enqueue([this.getBlobData,e,!1,o,i]):this.getBlobData(e,!1,o,i):this._state!==P?this.enqueue([this.dispatch,e,!1,o,i]):this.sendFrame(t.frame(e,o),i)}send(e,r,i){let s=this._extensions[Mt.extensionName],n=r.binary?2:1,o=r.compress,a,c;typeof e=="string"?(a=Buffer.byteLength(e),c=!1):K(e)?(a=e.size,c=!1):(e=B(e),a=e.length,c=B.readOnly),this._firstFragment?(this._firstFragment=!1,o&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=s._threshold),this._compress=o):(o=!1,n=0),r.fin&&(this._firstFragment=!0);let l={[O]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:c,rsv1:o};K(e)?this._state!==P?this.enqueue([this.getBlobData,e,this._compress,l,i]):this.getBlobData(e,this._compress,l,i):this._state!==P?this.enqueue([this.dispatch,e,this._compress,l,i]):this.dispatch(e,this._compress,l,i)}getBlobData(e,r,i,s){this._bufferedBytes+=i[O],this._state=js,e.arrayBuffer().then(n=>{if(this._socket.destroyed){let a=new Error("The socket was closed while the blob was being read");process.nextTick(Xe,this,a,s);return}this._bufferedBytes-=i[O];let o=B(n);r?this.dispatch(o,r,i,s):(this._state=P,this.sendFrame(t.frame(o,i),s),this.dequeue())}).catch(n=>{process.nextTick(qs,this,n,s)})}dispatch(e,r,i,s){if(!r){this.sendFrame(t.frame(e,i),s);return}let n=this._extensions[Mt.extensionName];this._bufferedBytes+=i[O],this._state=$s,n.compress(e,i.fin,(o,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");Xe(this,c,s);return}this._bufferedBytes-=i[O],this._state=P,i.readOnly=!1,this.sendFrame(t.frame(a,i),s),this.dequeue()})}dequeue(){for(;this._state===P&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][O],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][O],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};$t.exports=Ke;function Xe(t,e,r){typeof r=="function"&&r(e);for(let i=0;i<t._queue.length;i++){let s=t._queue[i],n=s[s.length-1];typeof n=="function"&&n(e)}}function qs(t,e,r){Xe(t,e,r),t.onerror(e)}});var Zt=v((fn,Jt)=>{"use strict";var{kForOnEventAttribute:fe,kListener:et}=L(),jt=Symbol("kCode"),qt=Symbol("kData"),Vt=Symbol("kError"),Gt=Symbol("kMessage"),zt=Symbol("kReason"),Q=Symbol("kTarget"),Ht=Symbol("kType"),Yt=Symbol("kWasClean"),R=class{constructor(e){this[Q]=null,this[Ht]=e}get target(){return this[Q]}get type(){return this[Ht]}};Object.defineProperty(R.prototype,"target",{enumerable:!0});Object.defineProperty(R.prototype,"type",{enumerable:!0});var W=class extends R{constructor(e,r={}){super(e),this[jt]=r.code===void 0?0:r.code,this[zt]=r.reason===void 0?"":r.reason,this[Yt]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[jt]}get reason(){return this[zt]}get wasClean(){return this[Yt]}};Object.defineProperty(W.prototype,"code",{enumerable:!0});Object.defineProperty(W.prototype,"reason",{enumerable:!0});Object.defineProperty(W.prototype,"wasClean",{enumerable:!0});var ee=class extends R{constructor(e,r={}){super(e),this[Vt]=r.error===void 0?null:r.error,this[Gt]=r.message===void 0?"":r.message}get error(){return this[Vt]}get message(){return this[Gt]}};Object.defineProperty(ee.prototype,"error",{enumerable:!0});Object.defineProperty(ee.prototype,"message",{enumerable:!0});var ue=class extends R{constructor(e,r={}){super(e),this[qt]=r.data===void 0?null:r.data}get data(){return this[qt]}};Object.defineProperty(ue.prototype,"data",{enumerable:!0});var Vs={addEventListener(t,e,r={}){for(let s of this.listeners(t))if(!r[fe]&&s[et]===e&&!s[fe])return;let i;if(t==="message")i=function(n,o){let a=new ue("message",{data:o?n:n.toString()});a[Q]=this,Te(e,this,a)};else if(t==="close")i=function(n,o){let a=new W("close",{code:n,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[Q]=this,Te(e,this,a)};else if(t==="error")i=function(n){let o=new ee("error",{error:n,message:n.message});o[Q]=this,Te(e,this,o)};else if(t==="open")i=function(){let n=new R("open");n[Q]=this,Te(e,this,n)};else return;i[fe]=!!r[fe],i[et]=e,r.once?this.once(t,i):this.on(t,i)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[et]===e&&!r[fe]){this.removeListener(t,r);break}}};Jt.exports={CloseEvent:W,ErrorEvent:ee,Event:R,EventTarget:Vs,MessageEvent:ue};function Te(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}});var tt=v((un,Kt)=>{"use strict";var{tokenChars:he}=Z();function N(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}function Gs(t){let e=Object.create(null),r=Object.create(null),i=!1,s=!1,n=!1,o,a,c=-1,l=-1,f=-1,u=0;for(;u<t.length;u++)if(l=t.charCodeAt(u),o===void 0)if(f===-1&&he[l]===1)c===-1&&(c=u);else if(u!==0&&(l===32||l===9))f===-1&&c!==-1&&(f=u);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);f===-1&&(f=u);let y=t.slice(c,f);l===44?(N(e,y,r),r=Object.create(null)):o=y,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);else if(a===void 0)if(f===-1&&he[l]===1)c===-1&&(c=u);else if(l===32||l===9)f===-1&&c!==-1&&(f=u);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);f===-1&&(f=u),N(r,t.slice(c,f),!0),l===44&&(N(e,o,r),r=Object.create(null),o=void 0),c=f=-1}else if(l===61&&c!==-1&&f===-1)a=t.slice(c,u),c=f=-1;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(s){if(he[l]!==1)throw new SyntaxError(`Unexpected character at index ${u}`);c===-1?c=u:i||(i=!0),s=!1}else if(n)if(he[l]===1)c===-1&&(c=u);else if(l===34&&c!==-1)n=!1,f=u;else if(l===92)s=!0;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(l===34&&t.charCodeAt(u-1)===61)n=!0;else if(f===-1&&he[l]===1)c===-1&&(c=u);else if(c!==-1&&(l===32||l===9))f===-1&&(f=u);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);f===-1&&(f=u);let y=t.slice(c,f);i&&(y=y.replace(/\\/g,""),i=!1),N(r,a,y),l===44&&(N(e,o,r),r=Object.create(null),o=void 0),a=void 0,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);if(c===-1||n||l===32||l===9)throw new SyntaxError("Unexpected end of input");f===-1&&(f=u);let d=t.slice(c,f);return o===void 0?N(e,d,r):(a===void 0?N(r,d,!0):i?N(r,a,d.replace(/\\/g,"")):N(r,a,d),N(e,o,r)),e}function zs(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(i=>[e].concat(Object.keys(i).map(s=>{let n=i[s];return Array.isArray(n)||(n=[n]),n.map(o=>o===!0?s:`${s}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Kt.exports={format:zs,parse:Gs}});var Ae=v((pn,cr)=>{"use strict";var Hs=p("events"),Ys=p("https"),Js=p("http"),er=p("net"),Zs=p("tls"),{randomBytes:Ks,createHash:Xs}=p("crypto"),{Duplex:hn,Readable:dn}=p("stream"),{URL:rt}=p("url"),F=ce(),Qs=Ze(),ei=Qe(),{isBlob:ti}=Z(),{BINARY_TYPES:Xt,EMPTY_BUFFER:Ne,GUID:ri,kForOnEventAttribute:st,kListener:si,kStatusCode:ii,kWebSocket:S,NOOP:tr}=L(),{EventTarget:{addEventListener:ni,removeEventListener:oi}}=Zt(),{format:ai,parse:li}=tt(),{toBuffer:ci}=ae(),fi=30*1e3,rr=Symbol("kAborted"),it=[8,13],D=["CONNECTING","OPEN","CLOSING","CLOSED"],ui=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,g=class t extends Hs{constructor(e,r,i){super(),this._binaryType=Xt[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Ne,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(i=r,r=[]):r=[r]),sr(this,e,r,i)):(this._autoPong=i.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){Xt.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,i){let s=new Qs({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation}),n=new ei(e,this._extensions,i.generateMask);this._receiver=s,this._sender=n,this._socket=e,s[S]=this,n[S]=this,e[S]=this,s.on("conclude",pi),s.on("drain",mi),s.on("error",_i),s.on("message",yi),s.on("ping",gi),s.on("pong",Si),n.onerror=Ei,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",or),e.on("data",Le),e.on("end",ar),e.on("error",lr),this._readyState=t.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[F.extensionName]&&this._extensions[F.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){w(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===t.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,i=>{i||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),nr(this)}}pause(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,i){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(i=e,e=r=void 0):typeof r=="function"&&(i=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){nt(this,e,i);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||Ne,r,i)}pong(e,r,i){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(i=e,e=r=void 0):typeof r=="function"&&(i=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){nt(this,e,i);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||Ne,r,i)}resume(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,i){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(i=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){nt(this,e,i);return}let s={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[F.extensionName]||(s.compress=!1),this._sender.send(e||Ne,s,i)}terminate(){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){w(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=t.CLOSING,this._socket.destroy())}}};Object.defineProperty(g,"CONNECTING",{enumerable:!0,value:D.indexOf("CONNECTING")});Object.defineProperty(g.prototype,"CONNECTING",{enumerable:!0,value:D.indexOf("CONNECTING")});Object.defineProperty(g,"OPEN",{enumerable:!0,value:D.indexOf("OPEN")});Object.defineProperty(g.prototype,"OPEN",{enumerable:!0,value:D.indexOf("OPEN")});Object.defineProperty(g,"CLOSING",{enumerable:!0,value:D.indexOf("CLOSING")});Object.defineProperty(g.prototype,"CLOSING",{enumerable:!0,value:D.indexOf("CLOSING")});Object.defineProperty(g,"CLOSED",{enumerable:!0,value:D.indexOf("CLOSED")});Object.defineProperty(g.prototype,"CLOSED",{enumerable:!0,value:D.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(g.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty(g.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[st])return e[si];return null},set(e){for(let r of this.listeners(t))if(r[st]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[st]:!0})}})});g.prototype.addEventListener=ni;g.prototype.removeEventListener=oi;cr.exports=g;function sr(t,e,r,i){let s={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:it[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...i,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=s.autoPong,!it.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${it.join(", ")})`);let n;if(e instanceof rt)n=e;else try{n=new rt(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}n.protocol==="http:"?n.protocol="ws:":n.protocol==="https:"&&(n.protocol="wss:"),t._url=n.href;let o=n.protocol==="wss:",a=n.protocol==="ws+unix:",c;if(n.protocol!=="ws:"&&!o&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`:a&&!n.pathname?c="The URL's pathname is empty":n.hash&&(c="The URL contains a fragment identifier"),c){let m=new SyntaxError(c);if(t._redirects===0)throw m;Ce(t,m);return}let l=o?443:80,f=Ks(16).toString("base64"),u=o?Ys.request:Js.request,d=new Set,y;if(s.createConnection=s.createConnection||(o?di:hi),s.defaultPort=s.defaultPort||l,s.port=n.port||l,s.host=n.hostname.startsWith("[")?n.hostname.slice(1,-1):n.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":f,Connection:"Upgrade",Upgrade:"websocket"},s.path=n.pathname+n.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(y=new F(s.perMessageDeflate!==!0?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=ai({[F.extensionName]:y.offer()})),r.length){for(let m of r){if(typeof m!="string"||!ui.test(m)||d.has(m))throw new SyntaxError("An invalid or duplicated subprotocol was specified");d.add(m)}s.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(n.username||n.password)&&(s.auth=`${n.username}:${n.password}`),a){let m=s.path.split(":");s.socketPath=m[0],s.path=m[1]}let _;if(s.followRedirects){if(t._redirects===0){t._originalIpc=a,t._originalSecure=o,t._originalHostOrSocketPath=a?s.socketPath:n.host;let m=i&&i.headers;if(i={...i,headers:{}},m)for(let[E,z]of Object.entries(m))i.headers[E.toLowerCase()]=z}else if(t.listenerCount("redirect")===0){let m=a?t._originalIpc?s.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:n.host===t._originalHostOrSocketPath;(!m||t._originalSecure&&!o)&&(delete s.headers.authorization,delete s.headers.cookie,m||delete s.headers.host,s.auth=void 0)}s.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),_=t._req=u(s),t._redirects&&t.emit("redirect",t.url,_)}else _=t._req=u(s);s.timeout&&_.on("timeout",()=>{w(t,_,"Opening handshake has timed out")}),_.on("error",m=>{_===null||_[rr]||(_=t._req=null,Ce(t,m))}),_.on("response",m=>{let E=m.headers.location,z=m.statusCode;if(E&&s.followRedirects&&z>=300&&z<400){if(++t._redirects>s.maxRedirects){w(t,_,"Maximum redirects exceeded");return}_.abort();let ne;try{ne=new rt(E,e)}catch{let H=new SyntaxError(`Invalid URL: ${E}`);Ce(t,H);return}sr(t,ne,r,i)}else t.emit("unexpected-response",_,m)||w(t,_,`Unexpected server response: ${m.statusCode}`)}),_.on("upgrade",(m,E,z)=>{if(t.emit("upgrade",m),t.readyState!==g.CONNECTING)return;_=t._req=null;let ne=m.headers.upgrade;if(ne===void 0||ne.toLowerCase()!=="websocket"){w(t,E,"Invalid Upgrade header");return}let pt=Xs("sha1").update(f+ri).digest("base64");if(m.headers["sec-websocket-accept"]!==pt){w(t,E,"Invalid Sec-WebSocket-Accept header");return}let H=m.headers["sec-websocket-protocol"],oe;if(H!==void 0?d.size?d.has(H)||(oe="Server sent an invalid subprotocol"):oe="Server sent a subprotocol but none was requested":d.size&&(oe="Server sent no subprotocol"),oe){w(t,E,oe);return}H&&(t._protocol=H);let mt=m.headers["sec-websocket-extensions"];if(mt!==void 0){if(!y){w(t,E,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Be;try{Be=li(mt)}catch{w(t,E,"Invalid Sec-WebSocket-Extensions header");return}let _t=Object.keys(Be);if(_t.length!==1||_t[0]!==F.extensionName){w(t,E,"Server indicated an extension that was not requested");return}try{y.accept(Be[F.extensionName])}catch{w(t,E,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[F.extensionName]=y}t.setSocket(E,z,{allowSynchronousEvents:s.allowSynchronousEvents,generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})}),s.finishRequest?s.finishRequest(_,t):_.end()}function Ce(t,e){t._readyState=g.CLOSING,t._errorEmitted=!0,t.emit("error",e),t.emitClose()}function hi(t){return t.path=t.socketPath,er.connect(t)}function di(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=er.isIP(t.host)?"":t.host),Zs.connect(t)}function w(t,e,r){t._readyState=g.CLOSING;let i=new Error(r);Error.captureStackTrace(i,w),e.setHeader?(e[rr]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(Ce,t,i)):(e.destroy(i),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}function nt(t,e,r){if(e){let i=ti(e)?e.size:ci(e).length;t._socket?t._sender._bufferedBytes+=i:t._bufferedAmount+=i}if(r){let i=new Error(`WebSocket is not open: readyState ${t.readyState} (${D[t.readyState]})`);process.nextTick(r,i)}}function pi(t,e){let r=this[S];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[S]!==void 0&&(r._socket.removeListener("data",Le),process.nextTick(ir,r._socket),t===1005?r.close():r.close(t,e))}function mi(){let t=this[S];t.isPaused||t._socket.resume()}function _i(t){let e=this[S];e._socket[S]!==void 0&&(e._socket.removeListener("data",Le),process.nextTick(ir,e._socket),e.close(t[ii])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t))}function Qt(){this[S].emitClose()}function yi(t,e){this[S].emit("message",t,e)}function gi(t){let e=this[S];e._autoPong&&e.pong(t,!this._isServer,tr),e.emit("ping",t)}function Si(t){this[S].emit("pong",t)}function ir(t){t.resume()}function Ei(t){let e=this[S];e.readyState!==g.CLOSED&&(e.readyState===g.OPEN&&(e._readyState=g.CLOSING,nr(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t)))}function nr(t){t._closeTimer=setTimeout(t._socket.destroy.bind(t._socket),fi)}function or(){let t=this[S];this.removeListener("close",or),this.removeListener("data",Le),this.removeListener("end",ar),t._readyState=g.CLOSING;let e;!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&(e=t._socket.read())!==null&&t._receiver.write(e),t._receiver.end(),this[S]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",Qt),t._receiver.on("finish",Qt))}function Le(t){this[S]._receiver.write(t)||this.pause()}function ar(){let t=this[S];t._readyState=g.CLOSING,t._receiver.end(),this.end()}function lr(){let t=this[S];this.removeListener("error",lr),this.on("error",tr),t&&(t._readyState=g.CLOSING,this.destroy())}});var dr=v((_n,hr)=>{"use strict";var mn=Ae(),{Duplex:xi}=p("stream");function fr(t){t.emit("close")}function vi(){!this.destroyed&&this._writableState.finished&&this.destroy()}function ur(t){this.removeListener("error",ur),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}function wi(t,e){let r=!0,i=new xi({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(n,o){let a=!o&&i._readableState.objectMode?n.toString():n;i.push(a)||t.pause()}),t.once("error",function(n){i.destroyed||(r=!1,i.destroy(n))}),t.once("close",function(){i.destroyed||i.push(null)}),i._destroy=function(s,n){if(t.readyState===t.CLOSED){n(s),process.nextTick(fr,i);return}let o=!1;t.once("error",function(c){o=!0,n(c)}),t.once("close",function(){o||n(s),process.nextTick(fr,i)}),r&&t.terminate()},i._final=function(s){if(t.readyState===t.CONNECTING){t.once("open",function(){i._final(s)});return}t._socket!==null&&(t._socket._writableState.finished?(s(),i._readableState.endEmitted&&i.destroy()):(t._socket.once("finish",function(){s()}),t.close()))},i._read=function(){t.isPaused&&t.resume()},i._write=function(s,n,o){if(t.readyState===t.CONNECTING){t.once("open",function(){i._write(s,n,o)});return}t.send(s,o)},i.on("end",vi),i.on("error",ur),i}hr.exports=wi});var mr=v((yn,pr)=>{"use strict";var{tokenChars:bi}=Z();function ki(t){let e=new Set,r=-1,i=-1,s=0;for(s;s<t.length;s++){let o=t.charCodeAt(s);if(i===-1&&bi[o]===1)r===-1&&(r=s);else if(s!==0&&(o===32||o===9))i===-1&&r!==-1&&(i=s);else if(o===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${s}`);i===-1&&(i=s);let a=t.slice(r,i);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),r=i=-1}else throw new SyntaxError(`Unexpected character at index ${s}`)}if(r===-1||i!==-1)throw new SyntaxError("Unexpected end of input");let n=t.slice(r,s);if(e.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);return e.add(n),e}pr.exports={parse:ki}});var vr=v((Sn,xr)=>{"use strict";var Oi=p("events"),Re=p("http"),{Duplex:gn}=p("stream"),{createHash:Pi}=p("crypto"),_r=tt(),$=ce(),Ti=mr(),Ni=Ae(),{GUID:Ci,kWebSocket:Li}=L(),Ai=/^[+/0-9A-Za-z]{22}==$/,yr=0,gr=1,Er=2,ot=class extends Oi{constructor(e,r){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Ni,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Re.createServer((i,s)=>{let n=Re.STATUS_CODES[426];s.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),s.end(n)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let i=this.emit.bind(this,"connection");this._removeListeners=Ri(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(s,n,o)=>{this.handleUpgrade(s,n,o,i)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=yr}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===Er){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(de,this);return}if(e&&this.once("close",e),this._state!==gr)if(this._state=gr,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(de,this):process.nextTick(de,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{de(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,i,s){r.on("error",Sr);let n=e.headers["sec-websocket-key"],o=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){j(this,e,r,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){j(this,e,r,400,"Invalid Upgrade header");return}if(n===void 0||!Ai.test(n)){j(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==13&&a!==8){j(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){pe(r,400);return}let c=e.headers["sec-websocket-protocol"],l=new Set;if(c!==void 0)try{l=Ti.parse(c)}catch{j(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],u={};if(this.options.perMessageDeflate&&f!==void 0){let d=new $(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let y=_r.parse(f);y[$.extensionName]&&(d.accept(y[$.extensionName]),u[$.extensionName]=d)}catch{j(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let d={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(d,(y,_,m,E)=>{if(!y)return pe(r,_||401,m,E);this.completeUpgrade(u,n,l,e,r,i,s)});return}if(!this.options.verifyClient(d))return pe(r,401)}this.completeUpgrade(u,n,l,e,r,i,s)}completeUpgrade(e,r,i,s,n,o,a){if(!n.readable||!n.writable)return n.destroy();if(n[Li])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>yr)return pe(n,503);let l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Pi("sha1").update(r+Ci).digest("base64")}`],f=new this.options.WebSocket(null,void 0,this.options);if(i.size){let u=this.options.handleProtocols?this.options.handleProtocols(i,s):i.values().next().value;u&&(l.push(`Sec-WebSocket-Protocol: ${u}`),f._protocol=u)}if(e[$.extensionName]){let u=e[$.extensionName].params,d=_r.format({[$.extensionName]:[u]});l.push(`Sec-WebSocket-Extensions: ${d}`),f._extensions=e}this.emit("headers",l,s),n.write(l.concat(`\r
`).join(`\r
`)),n.removeListener("error",Sr),f.setSocket(n,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick(de,this)})),a(f,s)}};xr.exports=ot;function Ri(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return function(){for(let i of Object.keys(e))t.removeListener(i,e[i])}}function de(t){t._state=Er,t.emit("close")}function Sr(){this.destroy()}function pe(t,e,r,i){r=r||Re.STATUS_CODES[e],i={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...i},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${Re.STATUS_CODES[e]}\r
`+Object.keys(i).map(s=>`${s}: ${i[s]}`).join(`\r
`)+`\r
\r
`+r)}function j(t,e,r,i,s,n){if(t.listenerCount("wsClientError")){let o=new Error(s);Error.captureStackTrace(o,j),t.emit("wsClientError",o,r,e)}else pe(r,i,s,n)}});var Pr={};yt(Pr,{Receiver:()=>br.default,Sender:()=>kr.default,WebSocket:()=>at.default,WebSocketServer:()=>Or.default,createWebSocketStream:()=>wr.default,default:()=>Di});var wr,br,kr,at,Or,Di,Tr=ps(()=>{"use strict";wr=x(dr(),1),br=x(Ze(),1),kr=x(Qe(),1),at=x(Ae(),1),Or=x(vr(),1),Di=at.default});var Qi={};yt(Qi,{ProcessParams:()=>as,default:()=>Xi,defaultProcessProps:()=>T});var Ii=Object.defineProperty,h=(t,e)=>Ii(t,"name",{value:e,configurable:!0}),Cr=(t=>typeof p<"u"?p:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof p<"u"?p:e)[r]}):t)(function(t){if(typeof p<"u")return p.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),Fi=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:e*4-205]=e;return r=>{for(var i=r.length,s=new Uint8Array((i-(r[i-1]=="=")-(r[i-2]=="="))*3/4|0),n=0,o=0;n<i;){var a=t[r.charCodeAt(n++)],c=t[r.charCodeAt(n++)],l=t[r.charCodeAt(n++)],f=t[r.charCodeAt(n++)];s[o++]=a<<2|c>>4,s[o++]=c<<4|l>>2,s[o++]=l<<6|f}return s}})();function Lr(t){return!isNaN(parseFloat(t))&&isFinite(t)}h(Lr,"_isNumber");function U(t){return t.charAt(0).toUpperCase()+t.substring(1)}h(U,"_capitalize");function Ie(t){return function(){return this[t]}}h(Ie,"_getter");var te=["isConstructor","isEval","isNative","isToplevel"],re=["columnNumber","lineNumber"],se=["fileName","functionName","source"],Ui=["args"],Bi=["evalOrigin"],De=te.concat(re,se,Ui,Bi);function b(t){if(t)for(var e=0;e<De.length;e++)t[De[e]]!==void 0&&this["set"+U(De[e])](t[De[e]])}h(b,"StackFrame");b.prototype={getArgs:h(function(){return this.args},"getArgs"),setArgs:h(function(t){if(Object.prototype.toString.call(t)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=t},"setArgs"),getEvalOrigin:h(function(){return this.evalOrigin},"getEvalOrigin"),setEvalOrigin:h(function(t){if(t instanceof b)this.evalOrigin=t;else if(t instanceof Object)this.evalOrigin=new b(t);else throw new TypeError("Eval Origin must be an Object or StackFrame")},"setEvalOrigin"),toString:h(function(){var t=this.getFileName()||"",e=this.getLineNumber()||"",r=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?t?"[eval] ("+t+":"+e+":"+r+")":"[eval]:"+e+":"+r:i?i+" ("+t+":"+e+":"+r+")":t+":"+e+":"+r},"toString")};b.fromString=h(function(t){var e=t.indexOf("("),r=t.lastIndexOf(")"),i=t.substring(0,e),s=t.substring(e+1,r).split(","),n=t.substring(r+1);if(n.indexOf("@")===0)var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(n,""),a=o[1],c=o[2],l=o[3];return new b({functionName:i,args:s||void 0,fileName:a,lineNumber:c||void 0,columnNumber:l||void 0})},"StackFrame$$fromString");for(q=0;q<te.length;q++)b.prototype["get"+U(te[q])]=Ie(te[q]),b.prototype["set"+U(te[q])]=(function(t){return function(e){this[t]=!!e}})(te[q]);var q;for(V=0;V<re.length;V++)b.prototype["get"+U(re[V])]=Ie(re[V]),b.prototype["set"+U(re[V])]=(function(t){return function(e){if(!Lr(e))throw new TypeError(t+" must be a Number");this[t]=Number(e)}})(re[V]);var V;for(G=0;G<se.length;G++)b.prototype["get"+U(se[G])]=Ie(se[G]),b.prototype["set"+U(se[G])]=(function(t){return function(e){this[t]=String(e)}})(se[G]);var G,lt=b;function Ar(){var t=/^\s*at .*(\S+:\d+|\(native\))/m,e=/^(eval@)?(\[native code])?$/;return{parse:h(function(r){if(r.stack&&r.stack.match(t))return this.parseV8OrIE(r);if(r.stack)return this.parseFFOrSafari(r);throw new Error("Cannot parse given Error object")},"ErrorStackParser$$parse"),extractLocation:h(function(r){if(r.indexOf(":")===-1)return[r];var i=/(.+?)(?::(\d+))?(?::(\d+))?$/,s=i.exec(r.replace(/[()]/g,""));return[s[1],s[2]||void 0,s[3]||void 0]},"ErrorStackParser$$extractLocation"),parseV8OrIE:h(function(r){var i=r.stack.split(`
`).filter(function(s){return!!s.match(t)},this);return i.map(function(s){s.indexOf("(eval ")>-1&&(s=s.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=s.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),o=n.match(/ (\(.+\)$)/);n=o?n.replace(o[0],""):n;var a=this.extractLocation(o?o[1]:n),c=o&&n||void 0,l=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new lt({functionName:c,fileName:l,lineNumber:a[1],columnNumber:a[2],source:s})},this)},"ErrorStackParser$$parseV8OrIE"),parseFFOrSafari:h(function(r){var i=r.stack.split(`
`).filter(function(s){return!s.match(e)},this);return i.map(function(s){if(s.indexOf(" > eval")>-1&&(s=s.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),s.indexOf("@")===-1&&s.indexOf(":")===-1)return new lt({functionName:s});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,o=s.match(n),a=o&&o[1]?o[1]:void 0,c=this.extractLocation(s.replace(n,""));return new lt({functionName:a,fileName:c[0],lineNumber:c[1],columnNumber:c[2],source:s})},this)},"ErrorStackParser$$parseFFOrSafari")}}h(Ar,"ErrorStackParser");var Mi=new Ar,Wi=Mi,C=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!process.browser,Rr=C&&typeof module<"u"&&typeof module.exports<"u"&&typeof Cr<"u"&&typeof __dirname<"u",$i=C&&!Rr,En=typeof globalThis.Bun<"u",ji=typeof Deno<"u",Dr=!C&&!ji,qi=Dr&&typeof window=="object"&&typeof document=="object"&&typeof document.createElement=="function"&&"sessionStorage"in window&&typeof importScripts!="function",Vi=Dr&&typeof importScripts=="function"&&typeof self=="object",xn=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Chrome")==-1&&navigator.userAgent.indexOf("Safari")>-1,Fe=typeof read=="function"&&typeof load=="function",Ir,ft,Fr,Nr,ut;async function ht(){if(!C||(Ir=(await import("url")).default,Nr=await import("fs"),ut=await import("fs/promises"),Fr=(await import("vm")).default,ft=await import("path"),dt=ft.sep,typeof Cr<"u"))return;let t=Nr,e=await import("crypto"),r=await Promise.resolve().then(()=>(Tr(),Pr)),i=await import("child_process"),s={fs:t,crypto:e,ws:r,child_process:i};globalThis.require=function(n){return s[n]}}h(ht,"initNodeModules");function Ur(t,e){return ft.resolve(e||".",t)}h(Ur,"node_resolvePath");function Br(t,e){return e===void 0&&(e=location),new URL(t,e).toString()}h(Br,"browser_resolvePath");var ye;C?ye=Ur:Fe?ye=h(t=>t,"resolvePath"):ye=Br;var dt;C||(dt="/");function Mr(t,e){return t.startsWith("file://")&&(t=t.slice(7)),t.includes("://")?{response:fetch(t)}:{binary:ut.readFile(t).then(r=>new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}}h(Mr,"node_getBinaryResponse");function Wr(t,e){if(t.startsWith("file://")&&(t=t.slice(7)),t.includes("://"))throw new Error("Shell cannot fetch urls");return{binary:Promise.resolve(new Uint8Array(readbuffer(t)))}}h(Wr,"shell_getBinaryResponse");function $r(t,e){let r=new URL(t,location);return{response:fetch(r,e?{integrity:e}:{})}}h($r,"browser_getBinaryResponse");var ge;C?ge=Mr:Fe?ge=Wr:ge=$r;async function jr(t,e){let{response:r,binary:i}=ge(t,e);if(i)return i;let s=await r;if(!s.ok)throw new Error(`Failed to load '${t}': request failed.`);return new Uint8Array(await s.arrayBuffer())}h(jr,"loadBinaryFile");var me;if(qi)me=h(async t=>await import(t),"loadScript");else if(Vi)me=h(async t=>{try{globalThis.importScripts(t)}catch(e){if(e instanceof TypeError)await import(t);else throw e}},"loadScript");else if(C)me=qr;else if(Fe)me=load;else throw new Error("Cannot determine runtime environment");async function qr(t){t.startsWith("file://")&&(t=t.slice(7)),t.includes("://")?Fr.runInThisContext(await(await fetch(t)).text()):await import(Ir.pathToFileURL(t).href)}h(qr,"nodeLoadScript");async function Vr(t){if(C){await ht();let e=await ut.readFile(t,{encoding:"utf8"});return JSON.parse(e)}else if(Fe){let e=read(t);return JSON.parse(e)}else return await(await fetch(t)).json()}h(Vr,"loadLockFile");async function Gr(){if(Rr)return __dirname;let t;try{throw new Error}catch(i){t=i}let e=Wi.parse(t)[0].fileName;if(C&&!e.startsWith("file://")&&(e=`file://${e}`),$i){let i=await import("path");return(await import("url")).fileURLToPath(i.dirname(e))}let r=e.lastIndexOf(dt);if(r===-1)throw new Error("Could not extract indexURL path from pyodide module location");return e.slice(0,r)}h(Gr,"calculateDirname");function zr(t){return t.substring(0,t.lastIndexOf("/")+1)||globalThis.location?.toString()||"."}h(zr,"calculateInstallBaseUrl");function Hr(t){let e=t.FS,r=t.FS.filesystems.MEMFS,i=t.PATH,s={DIR_MODE:16895,FILE_MODE:33279,mount:h(function(n){if(!n.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return r.mount.apply(null,arguments)},"mount"),syncfs:h(async(n,o,a)=>{try{let c=s.getLocalSet(n),l=await s.getRemoteSet(n),f=o?l:c,u=o?c:l;await s.reconcile(n,f,u),a(null)}catch(c){a(c)}},"syncfs"),getLocalSet:h(n=>{let o=Object.create(null);function a(f){return f!=="."&&f!==".."}h(a,"isRealDir");function c(f){return u=>i.join2(f,u)}h(c,"toAbsolute");let l=e.readdir(n.mountpoint).filter(a).map(c(n.mountpoint));for(;l.length;){let f=l.pop(),u=e.stat(f);e.isDir(u.mode)&&l.push.apply(l,e.readdir(f).filter(a).map(c(f))),o[f]={timestamp:u.mtime,mode:u.mode}}return{type:"local",entries:o}},"getLocalSet"),getRemoteSet:h(async n=>{let o=Object.create(null),a=await Gi(n.opts.fileSystemHandle);for(let[c,l]of a)c!=="."&&(o[i.join2(n.mountpoint,c)]={timestamp:l.kind==="file"?new Date((await l.getFile()).lastModified):new Date,mode:l.kind==="file"?s.FILE_MODE:s.DIR_MODE});return{type:"remote",entries:o,handles:a}},"getRemoteSet"),loadLocalEntry:h(n=>{let o=e.lookupPath(n).node,a=e.stat(n);if(e.isDir(a.mode))return{timestamp:a.mtime,mode:a.mode};if(e.isFile(a.mode))return o.contents=r.getFileDataAsTypedArray(o),{timestamp:a.mtime,mode:a.mode,contents:o.contents};throw new Error("node type not supported")},"loadLocalEntry"),storeLocalEntry:h((n,o)=>{if(e.isDir(o.mode))e.mkdirTree(n,o.mode);else if(e.isFile(o.mode))e.writeFile(n,o.contents,{canOwn:!0});else throw new Error("node type not supported");e.chmod(n,o.mode),e.utime(n,o.timestamp,o.timestamp)},"storeLocalEntry"),removeLocalEntry:h(n=>{var o=e.stat(n);e.isDir(o.mode)?e.rmdir(n):e.isFile(o.mode)&&e.unlink(n)},"removeLocalEntry"),loadRemoteEntry:h(async n=>{if(n.kind==="file"){let o=await n.getFile();return{contents:new Uint8Array(await o.arrayBuffer()),mode:s.FILE_MODE,timestamp:new Date(o.lastModified)}}else{if(n.kind==="directory")return{mode:s.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+n.kind)}},"loadRemoteEntry"),storeRemoteEntry:h(async(n,o,a)=>{let c=n.get(i.dirname(o)),l=e.isFile(a.mode)?await c.getFileHandle(i.basename(o),{create:!0}):await c.getDirectoryHandle(i.basename(o),{create:!0});if(l.kind==="file"){let f=await l.createWritable();await f.write(a.contents),await f.close()}n.set(o,l)},"storeRemoteEntry"),removeRemoteEntry:h(async(n,o)=>{await n.get(i.dirname(o)).removeEntry(i.basename(o)),n.delete(o)},"removeRemoteEntry"),reconcile:h(async(n,o,a)=>{let c=0,l=[];Object.keys(o.entries).forEach(function(d){let y=o.entries[d],_=a.entries[d];(!_||e.isFile(y.mode)&&y.timestamp.getTime()>_.timestamp.getTime())&&(l.push(d),c++)}),l.sort();let f=[];if(Object.keys(a.entries).forEach(function(d){o.entries[d]||(f.push(d),c++)}),f.sort().reverse(),!c)return;let u=o.type==="remote"?o.handles:a.handles;for(let d of l){let y=i.normalize(d.replace(n.mountpoint,"/")).substring(1);if(a.type==="local"){let _=u.get(y),m=await s.loadRemoteEntry(_);s.storeLocalEntry(d,m)}else{let _=s.loadLocalEntry(d);await s.storeRemoteEntry(u,y,_)}}for(let d of f)if(a.type==="local")s.removeLocalEntry(d);else{let y=i.normalize(d.replace(n.mountpoint,"/")).substring(1);await s.removeRemoteEntry(u,y)}},"reconcile")};t.FS.filesystems.NATIVEFS_ASYNC=s}h(Hr,"initializeNativeFS");var Gi=h(async t=>{let e=[];async function r(s){for await(let n of s.values())e.push(n),n.kind==="directory"&&await r(n)}h(r,"collect"),await r(t);let i=new Map;i.set(".",t);for(let s of e){let n=(await t.resolve(s)).join("/");i.set(n,s)}return i},"getFsHandles"),zi=Fi("AGFzbQEAAAABDANfAGAAAW9gAW8BfwMDAgECByECD2NyZWF0ZV9zZW50aW5lbAAAC2lzX3NlbnRpbmVsAAEKEwIHAPsBAPsbCwkAIAD7GvsUAAs="),Hi=(async function(){if(!(globalThis.navigator&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&typeof navigator.maxTouchPoints<"u"&&navigator.maxTouchPoints>1)))try{let t=await WebAssembly.compile(zi);return await WebAssembly.instantiate(t)}catch(t){if(t instanceof WebAssembly.CompileError)return;throw t}})();async function Yr(){let t=await Hi;if(t)return t.exports;let e=Symbol("error marker");return{create_sentinel:h(()=>e,"create_sentinel"),is_sentinel:h(r=>r===e,"is_sentinel")}}h(Yr,"getSentinelImport");function Jr(t){let e={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:ts(t),print:t.stdout,printErr:t.stderr,onExit(r){e.exitCode=r},thisProgram:t._sysExecutable,arguments:t.args,API:{config:t},locateFile:h(r=>t.indexURL+r,"locateFile"),instantiateWasm:rs(t.indexURL)};return e}h(Jr,"createSettings");function Zr(t){return function(e){let r="/";try{e.FS.mkdirTree(t)}catch(i){console.error(`Error occurred while making a home directory '${t}':`),console.error(i),console.error(`Using '${r}' for a home directory instead`),t=r}e.FS.chdir(t)}}h(Zr,"createHomeDirectory");function Kr(t){return function(e){Object.assign(e.ENV,t)}}h(Kr,"setEnvironment");function Xr(t){return t?[async e=>{e.addRunDependency("fsInitHook");try{await t(e.FS,{sitePackages:e.API.sitePackages})}finally{e.removeRunDependency("fsInitHook")}}]:[]}h(Xr,"callFsInitHook");function Qr(t){let e=t.HEAPU32[t._Py_Version>>>2],r=e>>>24&255,i=e>>>16&255,s=e>>>8&255;return[r,i,s]}h(Qr,"computeVersionTuple");function es(t){let e=jr(t);return async r=>{r.API.pyVersionTuple=Qr(r);let[i,s]=r.API.pyVersionTuple;r.FS.mkdirTree("/lib"),r.API.sitePackages=`/lib/python${i}.${s}/site-packages`,r.FS.mkdirTree(r.API.sitePackages),r.addRunDependency("install-stdlib");try{let n=await e;r.FS.writeFile(`/lib/python${i}${s}.zip`,n)}catch(n){console.error("Error occurred while installing the standard library:"),console.error(n)}finally{r.removeRunDependency("install-stdlib")}}}h(es,"installStdlib");function ts(t){let e;return t.stdLibURL!=null?e=t.stdLibURL:e=t.indexURL+"python_stdlib.zip",[es(e),Zr(t.env.HOME),Kr(t.env),Hr,...Xr(t.fsInit)]}h(ts,"getFileSystemInitializationFuncs");function rs(t){if(typeof WasmOffsetConverter<"u")return;let{binary:e,response:r}=ge(t+"pyodide.asm.wasm"),i=Yr();return function(s,n){return(async function(){s.sentinel=await i;try{let o;r?o=await WebAssembly.instantiateStreaming(r,s):o=await WebAssembly.instantiate(await e,s);let{instance:a,module:c}=o;n(a,c)}catch(o){console.warn("wasm instantiation failed!"),console.warn(o)}})(),{}}}h(rs,"getInstantiateWasmFunc");var Yi="0.28.3";function _e(t){return t===void 0||t.endsWith("/")?t:t+"/"}h(_e,"withTrailingSlash");var ct=Yi;async function Ue(t={}){if(t.lockFileContents&&t.lockFileURL)throw new Error("Can't pass both lockFileContents and lockFileURL");await ht();let e=t.indexURL||await Gr();e=_e(ye(e));let r=t;if(r.packageBaseUrl=_e(r.packageBaseUrl),r.cdnUrl=_e(r.packageBaseUrl??`https://cdn.jsdelivr.net/pyodide/v${ct}/full/`),!t.lockFileContents){let u=t.lockFileURL??e+"pyodide-lock.json";r.lockFileContents=Vr(u),r.packageBaseUrl??=zr(u)}r.indexURL=e,r.packageCacheDir&&(r.packageCacheDir=_e(ye(r.packageCacheDir)));let i={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?globalThis.prompt:void 0,args:[],env:{},packages:[],packageCacheDir:r.packageBaseUrl,enableRunUntilComplete:!0,checkAPIVersion:!0,BUILD_ID:"cc7a4bb4c6f36f12592fef0934292b5fddb0e313ca5dc4a5a9519bb7610c67e3"},s=Object.assign(i,r);s.env.HOME??="/home/pyodide",s.env.PYTHONINSPECT??="1";let n=Jr(s),o=n.API;if(o.lockFilePromise=Promise.resolve(r.lockFileContents),typeof _createPyodideModule!="function"){let u=`${s.indexURL}pyodide.asm.js`;await me(u)}let a;if(t._loadSnapshot){let u=await t._loadSnapshot;ArrayBuffer.isView(u)?a=u:a=new Uint8Array(u),n.noInitialRun=!0,n.INITIAL_MEMORY=a.length}let c=await _createPyodideModule(n);if(n.exitCode!==void 0)throw new c.ExitStatus(n.exitCode);if(t.pyproxyToStringRepr&&o.setPyProxyToStringMethod(!0),t.convertNullToNone&&o.setCompatNullToNone(!0),o.version!==ct&&s.checkAPIVersion)throw new Error(`Pyodide version does not match: '${ct}' <==> '${o.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);c.locateFile=u=>{throw u.endsWith(".so")?new Error(`Failed to find dynamic library "${u}"`):new Error(`Unexpected call to locateFile("${u}")`)};let l;a&&(l=o.restoreSnapshot(a));let f=o.finalizeBootstrap(l,t._snapshotDeserializer);return o.sys.path.insert(0,""),o._pyodide.set_excepthook(),await o.packageIndexReady,o.initializeStreams(s.stdin,s.stdout,s.stderr),f}h(Ue,"loadPyodide");var ie=["jaconv-0.4.0-py3-none-any.whl","marisa_trie-1.3.2.dev0-cp313-cp313-pyodide_2025_0_wasm32.whl","aksharamukha-2.3-py3-none-any.whl"],ss="https://github.com/paramsiddharth/aksharamukha.js/releases/download/v2.3.0-0";var Ki={},os=typeof window>"u"||typeof process<"u"&&process.versions?.node,as={default:"default",scriptCode:"script_code",langCode:"lang_code",langName:"lang_name"},T={nativize:!0,param:as.default,preOptions:[],postOptions:[]},Se=class t{static _isTestEnv=!1;static _currentScript;pyodide;constructor(e){this.pyodide=e}static _setCurrentScript(e){this._currentScript=e}static async new(e){let r=e?.pyodide;r==null&&(this._isTestEnv?r=await Ji():r=await Ue()),await r.loadPackage("micropip");let i=r.pyimport("micropip");if(os){let n=await import("fs");for(let o of ie){let a,c=Zi();try{let l=`${c}/${o}`;a=n.readFileSync(l)}catch(l){console.warn(`Wheel file missing in script directory, trying ../../downloads: ${l}`);let f=`${c}/../../downloads/${o}`;a=n.readFileSync(f)}r.FS.writeFile(`/tmp/${o}`,a)}await i.install(ie.map(o=>`emfs:/tmp/${o}`),{keep_going:!0});for(let o of ie)r.FS.unlink(`/tmp/${o}`)}else try{let n=this._currentScript.src,o=n.substring(0,n.lastIndexOf("/"));await i.install(ie.map(a=>`${o}/${a}`),{keep_going:!0})}catch{await i.install(ie.map(n=>`${ss}/${n}`),{keep_going:!0})}r.runPython("from aksharamukha import *");let s=new t(r);return s.process("autodetect","Devanagari","praNAm"),s}async test(){if(await this.pyodide.runPythonAsync("1 + 1")!==2)throw new Error("Pyodide not functioning correctly.")}process(e,r,i,{nativize:s,param:n,preOptions:o,postOptions:a}=T){let c=is({src:e,tgt:r,txt:i,props:{nativize:s??T.nativize,param:n??T.param,preOptions:o??T.preOptions,postOptions:a??T.postOptions}});return this.pyodide.runPython(c)}async processAsync(e,r,i,{nativize:s,param:n,preOptions:o,postOptions:a}=T){let c=is({src:e,tgt:r,txt:i,props:{nativize:s??T.nativize,param:n??T.param,preOptions:o??T.preOptions,postOptions:a??T.postOptions}});return await this.pyodide.runPythonAsync(c)}autoDetect(e,r=!1){let i=ns({txt:e,plugin:r});return this.pyodide.runPython(i)}autoDetectAsync(e,r=!1){let i=ns({txt:e,plugin:r});return this.pyodide.runPythonAsync(i)}};async function Ji(){return await Ue({indexURL:"./node_modules/pyodide",packageCacheDir:"./node_modules/pyodide"})}function is(t){return`
		from aksharamukha import transliterate
		transliterate.process(
			${JSON.stringify(t.src)},
			${JSON.stringify(t.tgt)},
			${JSON.stringify(t.txt)},
			nativize=${t.props.nativize?"True":"False"},
			param=${JSON.stringify(t.props.param)},
			pre_options=${JSON.stringify(t.props.preOptions)},
			post_options=${JSON.stringify(t.props.postOptions)}
		)
	`}function ns(t){return`
		from aksharamukha import transliterate
		transliterate.auto_detect(
			${JSON.stringify(t.txt)},
			${t.plugin?"True":"False"}
		)
	`}function Zi(){if(!os)throw new Error("getCurrentDir is only supported in Node.js environment.");try{return __dirname}catch{return Ki.dirname}}var Xi=Se;return ms(Qi);})();

					Object.assign(window, { Aksharamukha: Aksharamukha.default });
					window.Aksharamukha._setCurrentScript(document.currentScript);
				
//# sourceMappingURL=index.global.js.map